function [u_p, A, B] = DMD_model_ident(x,u,u_ref)

% 
A = [x(1) x(2) x(3) x(4);
    x(5) x(6) x(7) x(8);
    x(9) x(10) x(11) x(12);
    x(13) x(14) x(15) x(16)];

B = [x(17) x(18) x(19) x(20);
    x(21) x(22) x(23) x(24);
    x(25) x(26) x(27) x(28);
    x(29) x(30) x(31) x(32)];

% A = zeros(4,4);
% A(1,1) = x(1);
% A(2,2) = x(2);
% A(3,3) = x(3);
% A(4,4) = x(4);
% 
% B = zeros(4,4);
% B(1,1) = x(5);
% B(2,2) = x(6);
% B(3,3) = x(7);
% B(4,4) = x(8);


u_p = A*u+B*u_ref;



end